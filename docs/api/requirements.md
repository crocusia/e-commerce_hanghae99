# 이커머스 서비스 요구사항 명세서

## 1. 개요
본 문서는 이커머스 서비스 애플리케이션의 핵심 기능에 대한 요구사항을 정의합니다.
회원가입 및 로그인 기능은 별도로 구현되어 있다고 가정하며, 상품 관리, 주문/결제, 쿠폰 시스템, 데이터 연동을 중심으로 작성되었습니다.
---

## 2. 기능적 요구사항 (Functional Requirements)

### 2.1 상품 관리
**FR-1.1 상품 정보 조회**
- 사용자는 상품의 상세 정보(상품명, 가격, 설명, 카테고리 등)를 조회함
- 상품 목록 조회 시 페이징 처리를 지원함

**FR-1.2 상품 옵션 관리**
- 상품은 여러 개의 옵션(색상, 사이즈 등)을 가짐
- 각 옵션 조합(예: 빨간색-L, 파란색-M)마다 독립적인 재고를 관리함
- 사용자는 상품 상세 조회 시 사용 가능한 모든 옵션 목록을 확인함
- 옵션별로 추가 금액 설정 가능 (예: XL 사이즈 +2,000원)

**FR-1.3 재고 실시간 확인**
- 사용자는 특정 상품 옵션의 현재 재고 수량을 실시간으로 확인함
- 재고가 부족한 경우 주문 시 적절한 안내 메시지를 제공함
- 선택한 옵션의 재고 상태(판매 가능, 품절 등)를 명확히 표시함

**FR-1.4 인기 상품 통계**
- 최근 3일간 판매량 기준 상위 5개 인기 상품을 조회함
- 인기 상품 통계는 일별로 집계됨

### 2.2 주문/결제 시스템
**FR-2.1 장바구니 기능**
- 사용자는 특정 옵션을 선택하여 상품을 장바구니에 추가/삭제함
- 장바구니에 담긴 상품의 옵션과 수량 변경 가능
- 장바구니에 상품 추가 또는 수량 변경 시 해당 옵션의 재고를 확인하여 재고 부족 시 적절한 안내 메시지를 제공함
- 장바구니 목록에는 상품명, 선택한 옵션, 수량, 옵션별 추가 금액이 포함된 가격을 표시함
- 장바구니의 총 금액을 조회함

**FR-2.2 재고 확인 및 차감**
- 주문 생성(결제 완료) 시 장바구니의 모든 상품 옵션에 대해 재고를 검증함
- 선택한 옵션의 재고가 충분한 경우에만 주문을 생성하고 재고를 자동으로 차감함
- 옵션이 없는 상품의 경우 기본 재고로 관리함

**FR-2.3 잔액 기반 결제**
- 사용자는 충전된 잔액으로 결제함
- 결제 시 사용자의 잔액이 충분한지 검증함
- 결제 완료 후 잔액을 차감함
- 잔액 충전 기능을 제공함

**FR-2.4 쿠폰 할인 적용**
- 결제 시 보유한 쿠폰을 선택하여 할인을 적용함
- 쿠폰 적용 후 최종 결제 금액을 계산함
- 사용된 쿠폰은 자동으로 사용 완료 처리함

### 2.3 쿠폰 시스템
**FR-3.1 선착순 발급**
- 쿠폰은 미리 정해진 한정 수량만큼만 발급함
- 선착순으로 발급되며, 수량이 소진되면 발급을 중단함
- 동시 다발적인 요청에서도 발급 수량을 정확하게 제어함

**FR-3.2 쿠폰 유효성 검증**
- 쿠폰 사용 시 발급 여부를 확인함
- 쿠폰의 사용 기한(유효 기간)을 검증함
- 이미 사용된 쿠폰은 재사용 불가

**FR-3.3 사용 이력 관리**
- 쿠폰 발급/사용 이력을 저장하고 조회함
- 사용자별 보유 쿠폰 목록을 조회함

### 2.4 데이터 연동
**FR-4.1 주문 데이터 외부 전송**
- 주문이 완료되면 주문 정보를 외부 데이터 플랫폼으로 전송함
- 전송할 데이터에는 주문 ID, 사용자 ID, 상품 정보, 결제 금액 등이 포함됨

**FR-4.2 데이터 전송 실패 처리**
- 외부 플랫폼으로의 데이터 전송이 실패하더라도 주문은 정상적으로 처리함
- 전송 실패 시 재시도 메커니즘 또는 로깅을 통해 추후 재전송 가능

---

## 3. 비기능적 요구사항 (Non-Functional Requirements)

### 3.1 성능 (Performance)
**NFR-1.1 응답 시간**
- 상품 조회 API는 평균 200ms 이내에 응답함
- 주문 생성 API는 평균 500ms 이내에 응답함

**NFR-1.2 동시 처리**
- 선착순 쿠폰 발급 시 동시 요청 1000건 이상을 처리함
- 재고 차감 시 동시성 문제 발생하지 않음 (Race Condition 방지)

**NFR-1.3 확장성**
- 시스템은 수평 확장 가능한 구조임
- 데이터베이스는 읽기 부하 분산을 위한 레플리카 구성 가능

### 3.2 가용성 (Availability)
**NFR-2.1 서비스 가동률**
- 서비스는 99.9% 이상의 가동률을 유지함

**NFR-2.2 장애 격리**
- 외부 데이터 플랫폼 장애가 주문 처리에 영향을 주지 않음
- 특정 기능의 장애가 전체 시스템에 영향을 주지 않도록 격리함

### 3.3 데이터 무결성 (Data Integrity)
**NFR-3.1 트랜잭션 관리**
- 주문 생성, 재고 차감, 잔액 차감, 쿠폰 사용 처리는 원자적(Atomic)으로 수행함
- 일부 작업이 실패할 경우 전체 작업을 롤백함

**NFR-3.2 데이터 정합성**
- 재고 수량은 실제 판매 수량과 항상 일치함
- 쿠폰 발급 수량은 설정된 한도를 초과하지 않음

### 3.4 보안 (Security)
**NFR-4.1 인증/인가**
- 모든 API는 인증된 사용자만 접근 가능
- 사용자는 자신의 주문 및 쿠폰 정보만 조회 가능

**NFR-4.2 데이터 암호화**
- 민감한 사용자 정보(결제 정보, 잔액 등)는 암호화하여 저장함

### 3.5 유지보수성 (Maintainability)
**NFR-5.1 로깅 및 모니터링**
- 모든 주요 기능(주문, 결제, 쿠폰 발급)에 대한 로그를 기록함
- 시스템 성능 및 에러를 실시간으로 모니터링 가능

**NFR-5.2 코드 품질**
- 코드는 SOLID 원칙을 준수하여 작성함
- 핵심 비즈니스 로직에 대한 단위 테스트 커버리지는 80% 이상임

**NFR-5.3 API 문서화**
- 모든 API는 Swagger 또는 OpenAPI를 통해 문서화함

### 3.6 사용성 (Usability)
**NFR-6.1 에러 메시지**
- 사용자에게 명확하고 이해하기 쉬운 에러 메시지를 제공함
- 재고 부족, 쿠폰 소진, 잔액 부족 등의 상황을 구체적으로 안내함

**NFR-6.2 응답 형식**
- API 응답은 일관된 JSON 형식을 사용함
- 성공/실패 여부, 메시지, 데이터를 명확히 구분함

---

## 4. 제약사항 (Constraints)

### 4.1 기술 제약
- 회원가입 및 로그인 기능은 이미 구현되어 있다고 가정함
- 외부 데이터 플랫폼은 HTTP REST API를 제공한다고 가정함

### 4.2 비즈니스 제약
- 쿠폰은 1인당 1회만 발급 가능 (중복 발급 방지)
- 주문 취소 기능은 현재 범위에 포함되지 않음

---